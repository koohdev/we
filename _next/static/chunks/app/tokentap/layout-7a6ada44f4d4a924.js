(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1341],{30629:function(e,t,a){Promise.resolve().then(a.bind(a,17017))},1811:function(e,t,a){"use strict";a.r(t),a.d(t,{GlobalContext:function(){return i},GlobalContextProvider:function(){return u},useGlobalContext:function(){return r}});var n=a(3827),o=a(9923),l=a(30522),s=a(64090);let i=(0,s.createContext)({openBrightIdModal:l.C3,closeBrightIdModal:l.C3,brightidModalStatus:o.jm.CLOSED,openHaveBrightIdAccountModal:l.C3,closeHaveBrightIdAccountModal:l.C3,haveBrightIdAccountModalStatus:o.v_.CLOSED,openBrightIdConnectionModal:l.C3,closeBrightIdConnectionModal:l.C3,brightIdConnectionModalStatus:o.g3.CLOSED,isWalletPromptOpen:!1,setIsWalletPromptOpen:l.C3}),r=()=>(0,s.useContext)(i),u=e=>{let{children:t}=e,[a,l]=(0,s.useState)(o.jm.CLOSED),[r,u]=(0,s.useState)(o.v_.CLOSED),[c,d]=(0,s.useState)(!1),[C,h]=(0,s.useState)(o.g3.CLOSED);return(0,n.jsx)(i.Provider,{value:{openBrightIdModal:()=>{l(o.jm.OPENED)},closeBrightIdModal:()=>{l(o.jm.CLOSED)},brightidModalStatus:a,openHaveBrightIdAccountModal:()=>{u(o.v_.OPENED)},closeHaveBrightIdAccountModal:()=>{u(o.v_.CLOSED)},haveBrightIdAccountModalStatus:r,openBrightIdConnectionModal:()=>{h(o.g3.OPENED)},closeBrightIdConnectionModal:()=>{h(o.g3.CLOSED)},brightIdConnectionModalStatus:C,isWalletPromptOpen:c,setIsWalletPromptOpen:d},children:t})}},17017:function(e,t,a){"use strict";a.r(t),a.d(t,{TokenTapContext:function(){return g},useTokenTapContext:function(){return k}});var n=a(3827),o=a(30522),l=a(64090),s=a(72450),i=a(37826),r=a(42339),u=a(50156),c=a(98055),d=a(1202),C=a(1811),h=a(23120);let g=(0,l.createContext)({claimError:void 0,tokensList:[],tokensListLoading:!1,claimTokenSignatureLoading:!1,claimedTokensList:[],handleClaimToken:o.C3,selectedTokenForClaim:null,setSelectedTokenForClaim:o.C3,claimTokenLoading:!1,openClaimModal:o.C3,closeClaimModal:o.C3,claimToken:o.C3,claimTokenResponse:null,searchPhrase:"",changeSearchPhrase:null,tokenListSearchResult:[],claimingTokenPk:null}),k=()=>(0,l.useContext)(g);t.default=e=>{let{children:t,tokens:a}=e,[o,k]=(0,l.useState)(a),[m,f]=(0,l.useState)(),[S,v]=(0,l.useState)(!1),[p,b]=(0,l.useState)(""),[E,I]=(0,l.useState)([]),[L,T]=(0,l.useState)(null),[M,w]=(0,l.useState)(null),[O,y]=(0,l.useState)(),[D,P]=(0,l.useState)(-1),x=(0,l.useMemo)(()=>{let e=p.toLowerCase();return o.filter(t=>t.name.toLowerCase().includes(e))},[p,o]),{address:B,isConnected:_,chainId:N}=(0,c.Pk)(),{setIsWalletPromptOpen:G}=(0,C.useGlobalContext)(),[H,A]=(0,l.useState)(!1),j=(0,c.YC)(),{writeContractAsync:R,isPending:W,reset:q,data:F,error:U}=(0,s.useWriteContract)({}),{userToken:J}=(0,i.useUserProfileContext)(),Q=(0,l.useCallback)(async()=>{try{let e=await(0,r.HJ)();k(e)}catch(e){console.log(e)}},[]),Y=(0,l.useCallback)(async()=>{if(J)try{let e=await(0,r.RU)(J);I(e)}catch(e){console.log(e)}},[J]),Z=(0,l.useCallback)(async(e,t)=>{let a;if(J&&B){q(),v(!0);try{a=await(0,r.dU)(J,e.id,B,t)}finally{v(!1)}return a}},[J,q,B,v]),z=(0,l.useCallback)(async(e,t)=>{if(!J||!L||!j)return;let a=h.q7.tokenTap[L.chain.chainId].erc20;if(!a)return;let n=Number(L.chain.chainId);A(!0);try{var o;let l=await Z(L),s=null!==(o=null==l?void 0:l.payload)&&void 0!==o?o:e;if(!s||!B||!n||!L)return;t||(t=l.id);let i=await(0,r.tO)(t,l.tokenDistribution.id,a);if(!i.success)throw Error("Error receiving shield from shield api");let u=[s.userWalletAddress,i.result.data.result.distributionId,i.result.data.result.claimId,i.result.reqId,{signature:i.result.signatures[0].signature,nonce:i.result.data.init.nonceAddress,owner:i.result.signatures[0].owner},i.result.shieldSignature],c=await j.estimateContractGas({abi:d.ovG,account:B,address:a,functionName:"claimToken",args:u}),C=await(null==R?void 0:R({args:u,abi:d.ovG,account:B,address:h.q7.tokenTap[L.chain.chainId].erc20,functionName:"claimToken",gas:c}));if(C){let e=await j.waitForTransactionReceipt({hash:C,confirmations:1});f({success:!0,state:"Done",txHash:e.transactionHash,message:"Token claimed successfully."}),await(0,r.Zr)(J,t,e.transactionHash)}}catch(e){f({success:!1,state:"Retry",message:e.shortMessage}),console.log(e)}finally{w(null),A(!1)}},[B,Z,j,L,J,R]),K=(0,l.useCallback)(async()=>{if(!L||W)return;let e=E.find(e=>e.tokenDistribution.id===L.id);z(null==e?void 0:e.payload,null==e?void 0:e.id)},[L,E,W,z]),V=(0,l.useCallback)(e=>{if(!_){G(!0);return}f(null),T(e)},[_,G]),X=(0,l.useCallback)(()=>{f(null),T(null)},[]);return(0,u.t2)(Y,h.sR,[J,Y]),(0,u.QG)(Q,[Q]),(0,n.jsx)(g.Provider,{value:{claimError:null==U?void 0:U.message,tokensList:o,tokenListSearchResult:x,claimTokenSignatureLoading:S,claimedTokensList:E,handleClaimToken:K,selectedTokenForClaim:L,setSelectedTokenForClaim:T,claimTokenLoading:H,openClaimModal:V,closeClaimModal:X,claimToken:Z,claimTokenResponse:m,searchPhrase:p,changeSearchPhrase:b,claimingTokenPk:M,tokensListLoading:!1},children:t})}}},function(e){e.O(0,[9299,3135,277,8819,141,2852,7826,1202,2971,8069,1744],function(){return e(e.s=30629)}),_N_E=e.O()}]);